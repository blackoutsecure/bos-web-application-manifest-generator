# Blackout Secure Web Application Manifest Generator

[![Marketplace](https://img.shields.io/badge/GitHub%20Marketplace-blue?logo=github)](https://github.com/marketplace/actions/web-manifest-generator)
[![GitHub release](https://img.shields.io/github/v/release/blackoutsecure/bos-web-application-manifest-generator?sort=semver)](https://github.com/blackoutsecure/bos-web-application-manifest-generator/releases)
[![License](https://img.shields.io/badge/license-Apache%202.0-blue)](LICENSE)
[![W3C Compliance](https://img.shields.io/badge/W3C-Compliant-green)](https://w3c.github.io/manifest/)

Generate W3C-compliant web manifest files for Progressive Web Apps with full customization. This GitHub Action handles all the complexity of creating valid manifests with support for icons, shortcuts, and automatic page injection.

## Features

- ‚úÖ **W3C Compliant** - Generates valid manifests per the official specification
- üì± **PWA Ready** - Full support for display modes, icons, shortcuts, and more
- üé® **Fully Customizable** - All standard manifest members supported
- üîç **Icon Validation** - Verify icon files exist with optional failure modes
- üíâ **Auto Page Injection** - Automatically adds manifest links to your HTML pages
- üåê **Internationalization** - Language and text direction support
- ‚ö° **Zero Config** - Works with sensible defaults, customize as needed

## Quick Start

### Standard Mode with Custom Icons

```yaml
- name: Generate Web Manifest
  uses: blackoutsecure/bos-web-application-manifest-generator@v1
  with:
    public_dir: 'dist'
    favicons: false
    name: 'My App'
    short_name: 'App'
    description: 'My Progressive Web App'
    theme_color: '#4285f4'
    background_color: '#ffffff'
    icons: |
      [
        {
          "src": "/icons/icon-192.png",
          "sizes": "192x192",
          "type": "image/png"
        },
        {
          "src": "/icons/icon-512.png",
          "sizes": "512x512",
          "type": "image/png",
          "purpose": "any maskable"
        }
      ]
```

### Favicons Mode (Quick Setup)

Use favicons mode for a quick setup with default favicon settings. This mode supports any favicon format and provides sensible defaults based on common favicon generator outputs (e.g., Android Chrome icons, Apple touch icons, etc.).

```yaml
- name: Generate Web Manifest
  uses: blackoutsecure/bos-web-application-manifest-generator@v1
  with:
    favicons: true
    public_dir: 'dist'
```

This generates a manifest with default values:

```json
{
  "name": "",
  "short_name": "",
  "icons": [
    {
      "src": "/android-chrome-192x192.png",
      "sizes": "192x192",
      "type": "image/png"
    },
    {
      "src": "/android-chrome-512x512.png",
      "sizes": "512x512",
      "type": "image/png"
    }
  ],
  "theme_color": "#ffffff",
  "background_color": "#ffffff",
  "display": "standalone",
  "start_url": "/"
}
```

**Note:** The default icons reference Android Chrome format (`/android-chrome-192x192.png` and `/android-chrome-512x512.png`), which is commonly generated by favicon tools. You can override these with any favicon paths using `favicons_options`.

### Favicons Mode with Custom Options

Override specific defaults using `favicons_options`. You can customize any manifest property including app name, icons, colors, and more:

```yaml
- name: Generate Web Manifest
  uses: blackoutsecure/bos-web-application-manifest-generator@v1
  with:
    public_dir: 'dist'
    favicons: true
    favicons_options: |
      {
        "name": "My App",
        "short_name": "App",
        "theme_color": "#4285f4",
        "background_color": "#1a1a1a",
        "display": "fullscreen"
      }
```

## Inputs

| Input                     | Description                                                                 | Default                                 |
| ------------------------- | --------------------------------------------------------------------------- | --------------------------------------- |
| `public_dir`              | Public directory where manifest will be written (e.g., dist, public, build) | **Required**                            |
| `favicons`                | Enable favicons mode (supports any favicon format)                          | **Required**                            |
| `name`                    | Application name                                                            | `""` (empty)                            |
| `short_name`              | Short name for limited space                                                | `""` (empty)                            |
| `description`             | Application description                                                     | -                                       |
| `start_url`               | App launch URL                                                              | `/`                                     |
| `scope`                   | Navigation scope                                                            | `/`                                     |
| `display`                 | Display mode: `standalone`, `fullscreen`, `minimal-ui`, or `browser`        | `standalone`                            |
| `theme_color`             | Theme color (hex)                                                           | `#ffffff`                               |
| `background_color`        | Background color (hex)                                                      | `#ffffff`                               |
| `favicons_options`        | JSON object to override favicons defaults                                   | -                                       |
| `icons`                   | JSON array of icon objects (not required if favicons enabled)               | Android Chrome icons (192x192, 512x512) |
| `filename`                | Output manifest filename                                                    | `site.webmanifest`                      |
| `inject_manifest_link`    | Auto-inject link tag into HTML pages                                        | `true`                                  |
| `icon_validation`         | Icon validation: `fail`, `warn`, or `none`                                  | `warn`                                  |
| `upload_artifacts`        | Upload generated manifest to GitHub artifacts                               | `true`                                  |
| `artifact_name`           | Name for the uploaded artifact                                              | `web-manifest`                          |
| `artifact_retention_days` | Number of days to retain artifact (1-90)                                    | Repository settings                     |

See the [action.yml](action.yml) for all available inputs including internationalization, shortcuts, categories, and advanced options.

### Default Values

When `favicons: false` (standard mode), the action uses these defaults:

- **Name/Short Name**: Empty strings (`""`)
- **Theme Color**: `#ffffff` (white)
- **Background Color**: `#ffffff` (white)
- **Display**: `standalone`
- **Icons**: Android Chrome format icons at `/android-chrome-192x192.png` and `/android-chrome-512x512.png`
- **Start URL**: `/`
- **Scope**: `/`

You can override any of these by explicitly setting the input values in your workflow.

## Favicons Mode

Favicons mode provides a quick way to generate a standard web manifest without manually specifying all properties. When enabled (`favicons: true`), it uses sensible defaults based on common favicon generator outputs.

**Default Settings:**

- **Icons**: Standard Android Chrome icon format at `/android-chrome-192x192.png` and `/android-chrome-512x512.png` (commonly generated by favicon tools like RealFaviconGenerator, Favicon.io, etc.)
- **Theme Color**: `#ffffff`
- **Background Color**: `#ffffff`
- **Display**: `standalone`
- **Name/Short Name**: Empty strings (override via `favicons_options` or top-level inputs)

You can override any of these defaults using the `favicons_options` parameter:

```yaml
favicons_options: |
  {
    "theme_color": "#ff5722",
    "background_color": "#212121",
    "icons": [
      {
        "src": "/custom-icon-192.png",
        "sizes": "192x192",
        "type": "image/png"
      }
    ]
  }
```

All standard manifest properties can be overridden through `favicons_options`.

### When to Use Each Mode

**Use Favicons Mode** (`favicons: true`) when:

- You want a quick setup with sensible defaults
- Your favicons are generated by common tools (e.g., RealFaviconGenerator, Favicon.io)
- Your icons follow the Android Chrome naming convention
- You prefer convention over configuration
- You want to override just a few properties via `favicons_options`

**Use Standard Mode** (`favicons: false`, `icons: [...]`) when:

- You need full control over every manifest property
- You have custom icon file names or non-standard paths
- You want to specify maskable icons, purposes, or multiple sizes explicitly
- You're migrating from an existing manifest with specific configurations
- You need detailed control over each icon's properties

## Icon Validation

The action validates that icon files referenced in your manifest actually exist on disk:

- **`fail`** - Fails the action if any icons are missing
- **`warn`** - Warns about missing icons but continues (default)
- **`none`** - Skips validation

```yaml
- name: Generate Web Manifest
  uses: blackoutsecure/bos-web-application-manifest-generator@v1
  with:
    public_dir: 'dist'
    favicons: false
    name: 'My App'
    icon_validation: 'fail'
    icons: |
      [
        {
          "src": "/icons/icon-192.png",
          "sizes": "192x192",
          "type": "image/png"
        }
      ]
```

## Artifact Upload

By default, the generated manifest file is automatically uploaded to GitHub artifacts for easy access and download. This is useful for:

- Downloading generated manifests after workflow runs
- Debugging manifest generation issues
- Archiving manifests for compliance or auditing
- Sharing manifests with team members

### Default Behavior

```yaml
- name: Generate Web Manifest
  uses: blackoutsecure/bos-web-application-manifest-generator@v1
  with:
    public_dir: 'dist'
    favicons: false
    name: 'My App'
    # Artifacts enabled by default
    # upload_artifacts: true
    # artifact_name: 'web-manifest'
```

### Disable Artifacts

Skip automatic artifact upload:

```yaml
- name: Generate Web Manifest
  uses: blackoutsecure/bos-web-application-manifest-generator@v1
  with:
    public_dir: 'dist'
    favicons: false
    name: 'My App'
    upload_artifacts: false
```

### Custom Artifact Configuration

Customize artifact name and retention:

```yaml
- name: Generate Web Manifest
  uses: blackoutsecure/bos-web-application-manifest-generator@v1
  with:
    public_dir: 'dist'
    favicons: false
    name: 'My App'
    upload_artifacts: true
    artifact_name: 'pwa-manifest'
    artifact_retention_days: 30 # Keep for 30 days
```

**Artifact Retention:**

- Default: Uses repository's default retention settings
- Range: 1-90 days
- Leave empty to use repository defaults

## Auto Page Injection

By default, the action automatically injects a manifest link into your HTML pages:

```html
<link rel="manifest" href="/site.webmanifest" />
```

Disable with `inject_manifest_link: false` or specify custom file extensions:

```yaml
- name: Generate Web Manifest
  uses: blackoutsecure/bos-web-application-manifest-generator@v1
  with:
    public_dir: 'dist'
    favicons: false
    name: 'My App'
    inject_manifest_link_exts: 'html htm php'
```

## Example Manifest Output

```json
{
  "name": "My Progressive Web App",
  "short_name": "MyPWA",
  "description": "An amazing Progressive Web Application",
  "start_url": "/",
  "scope": "/",
  "display": "standalone",
  "theme_color": "#4285f4",
  "background_color": "#ffffff",
  "icons": [
    {
      "src": "/icons/icon-192.png",
      "sizes": "192x192",
      "type": "image/png"
    },
    {
      "src": "/icons/icon-512.png",
      "sizes": "512x512",
      "type": "image/png",
      "purpose": "any maskable"
    }
  ]
}
```

## Linking the Manifest

Add this to your HTML `<head>`:

```html
<link rel="manifest" href="/site.webmanifest" />
```

Or let the action do it automatically with `inject_manifest_link: true`.

## Resources

- [W3C Web Application Manifest Specification](https://w3c.github.io/manifest/)
- [MDN Web App Manifests](https://developer.mozilla.org/en-US/docs/Web/Manifest)
- [MDN Progressive Web Apps](https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps)

## Development

### Version Management

This project uses automated version management. The version is synchronized across:

- `package.json`
- `src/lib/project-config.js`
- `src/index.js`

**Version Commands:**

```bash
# Get current version
npm run ver:get

# Increment patch version (1.0.0 ‚Üí 1.0.1)
npm run ver:patch

# Increment minor version (1.0.0 ‚Üí 1.1.0)
npm run ver:minor

# Increment major version (1.0.0 ‚Üí 2.0.0)
npm run ver:major
```

### Release Process

The release process is fully automated and includes:

1. Version bumping across all files
2. Building distribution files
3. Running tests
4. Git commit and tagging
5. Creating moving tags (`v1`, `latest`)

**Release Commands:**

```bash
# Auto-increment patch and release
npm run release patch

# Auto-increment minor and release
npm run release minor

# Auto-increment major and release
npm run release major

# Release specific version
npm run release 1.2.3
```

**What happens during release:**

- Updates version in all files
- Builds `dist/` folder
- Runs full test suite
- Commits changes to git
- Creates version tag (e.g., `v1.0.1`)
- Creates/updates moving tag (e.g., `v1`)
- Creates/updates `latest` tag
- Pushes everything to GitHub

**After release:**

1. Go to [GitHub Releases](https://github.com/blackoutsecure/bos-web-application-manifest-generator/releases)
2. Draft a new release for the tag
3. Check "Publish this Action to the GitHub Marketplace"
4. Select appropriate category
5. Publish the release

### Version Tags

Users can reference this action using:

- `@v1.0.1` - Specific version (recommended for stability)
- `@v1` - Latest v1.x.x release (auto-updates)
- `@latest` - Always the latest release (use with caution)

## License

Apache License 2.0 - See [LICENSE](LICENSE) for details.
